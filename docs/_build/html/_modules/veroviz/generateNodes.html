
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>veroviz.generateNodes &#8212; veroviz 0.3.0 documentation</title>
    <link rel="stylesheet" href="../../_static/lglb-sphinx-doc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
<div class="header">
 <p class="logo"><a href="https://veroviz.org">
  <img class="logo" src="../../_static/optimator_lab_transparency_small.png" alt="Logo"/>
 </a></p>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">veroviz 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../veroviz.html" accesskey="U">veroviz</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for veroviz.generateNodes</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">veroviz._common</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">veroviz._validation</span> <span class="k">import</span> <span class="n">valGenerateNodes</span>
<span class="kn">from</span> <span class="nn">veroviz._validation</span> <span class="k">import</span> <span class="n">valCreateNodesFromLocs</span>

<span class="kn">from</span> <span class="nn">veroviz._getSnapLoc</span> <span class="k">import</span> <span class="n">privGetSnapLocBatch</span>
<span class="kn">from</span> <span class="nn">veroviz._createEntitiesFromList</span> <span class="k">import</span> <span class="n">privCreateNodesFromLocs</span>
<span class="kn">from</span> <span class="nn">veroviz._internal</span> <span class="k">import</span> <span class="n">randomPick</span>
<span class="kn">from</span> <span class="nn">veroviz._internal</span> <span class="k">import</span> <span class="n">areaOfTriangle</span>

<span class="kn">from</span> <span class="nn">veroviz._geometry</span> <span class="k">import</span> <span class="n">geoDistance2D</span>
<span class="kn">from</span> <span class="nn">veroviz._geometry</span> <span class="k">import</span> <span class="n">geoIsPointInPoly</span>
<span class="kn">from</span> <span class="nn">veroviz._geometry</span> <span class="k">import</span> <span class="n">geoPointInDistance2D</span>

<span class="kn">from</span> <span class="nn">veroviz.utilities</span> <span class="k">import</span> <span class="n">initDataframe</span>
<span class="kn">from</span> <span class="nn">veroviz.utilities</span> <span class="k">import</span> <span class="n">getMapBoundary</span>


<div class="viewcode-block" id="generateNodes"><a class="viewcode-back" href="../../veroviz.generateNodes.html#veroviz.generateNodes.generateNodes">[docs]</a><span class="k">def</span> <span class="nf">generateNodes</span><span class="p">(</span><span class="n">initNodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodeType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodeName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numNodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">startNode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">incrementName</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">incrementStart</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nodeDistrib</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodeDistribArgs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">snapToRoad</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">leafletIconPrefix</span><span class="o">=</span><span class="n">VRV_DEFAULT_LEAFLETICONPREFIX</span><span class="p">,</span> <span class="n">leafletIconType</span><span class="o">=</span><span class="n">VRV_DEFAULT_LEAFLETICONTYPE</span><span class="p">,</span> <span class="n">leafletColor</span><span class="o">=</span><span class="n">VRV_DEFAULT_LEAFLETICONCOLOR</span><span class="p">,</span> <span class="n">leafletIconText</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cesiumIconType</span><span class="o">=</span><span class="n">VRV_DEFAULT_CESIUMICONTYPE</span><span class="p">,</span> <span class="n">cesiumColor</span><span class="o">=</span><span class="n">VRV_DEFAULT_CESIUMICONCOLOR</span><span class="p">,</span> <span class="n">cesiumIconText</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProvider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	This function generates a collection of nodes (locations).</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	initNodes: :ref:`Nodes`, Optional, default as None</span>
<span class="sd">		A :ref:`Nodes` dataframe containing an existing set of nodes. If `initNodes` is provided, this function will append to that dataframe.</span>
<span class="sd">	nodeType: string, Optional, default as None</span>
<span class="sd">		A user-defined text field that can be used to classify nodes. This field is to categorize a batch of nodes (e.g., &quot;warehouses&quot;). If provided, all nodes generated by the `generateNodes()` function call will be given this value. The nodeType is not used by VeRoViz explicitly. </span>
<span class="sd">	nodeName: string, Optional, default as None</span>
<span class="sd">		The name of all nodes that are to be generated by this function call. This field is a more detailed description (e.g., &quot;Buffalo WH&quot; or &quot;Berlin WH&quot;). The nodeName is not used by VeRoViz explicitly.  If provided, all nodes will use this nodeName.  See the `incrementName` flag below.</span>
<span class="sd">	numNodes: int, Required, default as None</span>
<span class="sd">		The number of nodes to be created.</span>
<span class="sd">	startNode: int, Optional, default as 1</span>
<span class="sd">		Specifies the starting node number.  This will be the maximum of startNode and any id values contained in the `id` column of the `initNodes` dataframe (if provided).  </span>
<span class="sd">	incrementName: boolean, Optional, default as False</span>
<span class="sd">		If this flag is set to `True, a unique integer value will be appended to the `nodeName`.  For example, if `nodeName = &#39;WH&#39;` and `incrementName = True`, then the effective node names for 3 nodes would be &#39;WH1&#39;, &#39;WH2&#39;, and &#39;WH3&#39;.</span>
<span class="sd">	incrementStart: int, Optional, default as 1</span>
<span class="sd">		The starting number of the nodeName increment.  See the `nodeName` and `incrementName` parameters above.</span>
<span class="sd">	nodeDistrib: string, Required, default as None</span>
<span class="sd">		Specifies a distribution by which the nodes will be generated.  See the table in the notes below for more information.</span>
<span class="sd">	nodeDistribArgs: dictionary, Required, default as None</span>
<span class="sd">		A dictionary of arguments for the distribution. See the table in the notes below for more information.</span>
<span class="sd">	snapToRoad: boolean, Optional, default as False, </span>
<span class="sd">		If True, nodes will be positioned at locations on the road network. This requires the use of a data provider. See :ref:`Data Providers` for a list of data providers that support this option.</span>
<span class="sd">	leafletIconPrefix: string, Optional, default as &quot;glyphicon&quot;</span>
<span class="sd">		There are a large number of Leaflet icons available. The `leafletIconPrefix` identifies one of two collections: &quot;glyphicon&quot; or &quot;fa&quot;.  See :ref:`Leaflet Style` for more information.</span>
<span class="sd">	leafletIconType: string, Optional, default as &quot;info-sign&quot;</span>
<span class="sd">		Specifies the particular icon to be used for all generated nodes.  The list of available options depends on the choice of `leafletIconType`. See :ref:`Leaflet Style` for available options.</span>
<span class="sd">	leafletColor: string, Optional, default as &quot;blue&quot;</span>
<span class="sd">		Specifies the icon color of the generated nodes when displayed in Leaflet. See :ref:`Leaflet Style` for a list of available colors.</span>
<span class="sd">	leafletIconText: string, Optional, default as None</span>
<span class="sd">		Specifies the text in label that will be displayed when the node is clicked on a Leaflet map.  This parameter allows for including more information if the node name itself is not sufficiently descriptive.</span>
<span class="sd">	cesiumIconType: string, Optional, default as &quot;pin&quot;</span>
<span class="sd">		&#39;pin&#39; is current the only option. See :ref:`Cesium Style`.</span>
<span class="sd">	cesiumColor: string, Optional, default as &quot;Cesium.Color.BLUE&quot;</span>
<span class="sd">		The color of the generated nodes when displayed in Cesium.  See :ref:`Cesium Style` for all available color options.</span>
<span class="sd">	cesiumIconText: string, Optional, default as None</span>
<span class="sd">		Text that will be permanently displayed within the node on a Cesium map. If this field is None, in Cesium the node will be displayed with the `id` value. </span>
<span class="sd">	dataProvider: string, Conditional, default as None</span>
<span class="sd">		Specifies the data source to be used for generating nodes on a road network. See :ref:`Data Providers` for options and requirements.</span>
<span class="sd">	dataProviderArgs: dictionary, Conditional, default as None</span>
<span class="sd">		For some data providers, additional parameters are required (e.g., API keys or database names). See :ref:`Data Providers` for the additional arguments required for each supported data provider.</span>

<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	:ref:`Nodes`</span>
<span class="sd">		A :ref:`Nodes` dataframe of generated nodes.</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	VeRoViz currently supports the following distribution options.  For each distribution, specific additional parameters (arguments) must be provided in the `nodeDistribArgs` Python dictionary.</span>

<span class="sd">	+---------------------------+-------------------------------------------------------+</span>
<span class="sd">	| `nodeDistrib` Option      | Keys in `nodeDistribArgs` Dictionary                  |</span>
<span class="sd">	+===========================+=======================================================+</span>
<span class="sd">	| &quot;uniformBB&quot;:              | &#39;boundingRegion&#39; : A list of [lat,lon] pairs defines  | </span>
<span class="sd">	| Uniformly distributed     | the boundary, in the form of [[lat1, lon1],           |</span>
<span class="sd">	| within a bounding region. | [lat2, lon2], ... , [latn, lonn]].                    |</span>
<span class="sd">	+---------------------------+-------------------------------------------------------+</span>
<span class="sd">	| &quot;normal&quot;:                 | &#39;center&#39; : Coordinate of center point, in form of     |</span>
<span class="sd">	| Normally distributed      | [lat, lon].                                           |</span>
<span class="sd">	| with a given center       |                                                       |</span>
<span class="sd">	| location and standard     +-------------------------------------------------------+</span>
<span class="sd">	| deviation. This option    | &#39;stdDev&#39; : Standard deviation in meters               |</span>
<span class="sd">	| does not require a        | (70% nodes are within this range)                     |</span>
<span class="sd">	| bounding region. If a     |                                                       |</span>
<span class="sd">	| boundary is provided, it  |                                                       | </span>
<span class="sd">	| will be regarded as       |                                                       |</span>
<span class="sd">	|  &quot;normalBB&quot;.              |                                                       |</span>
<span class="sd">	+---------------------------+-------------------------------------------------------+</span>
<span class="sd">	| &quot;normalBB&quot;:               | &#39;center&#39; : Coordinate of center point, in form of     |</span>
<span class="sd">	| Truncated normally        | [lat, lon].                                           |</span>
<span class="sd">	| distributed with a        |                                                       |</span>
<span class="sd">	| given center location     +-------------------------------------------------------+</span>
<span class="sd">	| and standard deviation.   | &#39;stdDev&#39; : Standard deviation, in meters              |</span>
<span class="sd">	|                           | (roughly 70% of nodes are within this range)          |</span>
<span class="sd">	|                           +-------------------------------------------------------+</span>
<span class="sd">	|                           | &#39;boundingRegion&#39; : A list of lat/lon defines the      |</span>
<span class="sd">	|                           | boundary, in the form of [[lat, lon], [lat, lon],     |</span>
<span class="sd">	|                           | ... , [lat, lon]]                                     |</span>
<span class="sd">	+---------------------------+-------------------------------------------------------+</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	First import veroviz and check if it is the latest version:</span>
<span class="sd">	    &gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">	    &gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	This first example will generate 20 nodes, normally distributed. The distribution is centered at lat 42.30, lon 78.00. The distribution has a standard deviation of 1000 meters.</span>
<span class="sd">	    &gt;&gt;&gt; myNodes = vrv.generateNodes(</span>
<span class="sd">	    ...     numNodes        = 20,</span>
<span class="sd">	    ...     nodeType        = &#39;depot&#39;, </span>
<span class="sd">	    ...     nodeDistrib     = &#39;normal&#39;, </span>
<span class="sd">	    ...     nodeDistribArgs = {</span>
<span class="sd">	    ...         &#39;center&#39; : [42.30, -78.00], </span>
<span class="sd">	    ...         &#39;stdDev&#39; : 1000</span>
<span class="sd">	    ...     })</span>
<span class="sd">	    &gt;&gt;&gt; myNodes</span>

<span class="sd">	View the center point, 1 std dev, 3 std devs, and resulting nodes on a Leaflet map:</span>
<span class="sd">	    &gt;&gt;&gt; myMap = vrv.addLeafletMarker(center      = [42.30, -78.00], </span>
<span class="sd">	    ...                              fillOpacity = 1)</span>
<span class="sd">	    &gt;&gt;&gt; myMap = vrv.addLeafletCircle(mapObject = myMap, </span>
<span class="sd">	    ...                              center    = [42.30, -78.00], </span>
<span class="sd">	    ...                              radius    = 1000, </span>
<span class="sd">	    ...                              fillColor = &#39;green&#39;)</span>
<span class="sd">	    &gt;&gt;&gt; myMap = vrv.addLeafletCircle(mapObject = myMap, </span>
<span class="sd">	    ...                              center    = [42.30, -78.00], </span>
<span class="sd">	    ...                              radius    = 3*1000)</span>
<span class="sd">	    &gt;&gt;&gt; myMap = vrv.createLeaflet(mapObject = myMap, </span>
<span class="sd">	    ...                           nodes     = myNodes)</span>
<span class="sd">	    &gt;&gt;&gt; myMap</span>

<span class="sd">	The following examples require a bounding region. For example:</span>
<span class="sd">	    &gt;&gt;&gt; bounding = [</span>
<span class="sd">	    ...     [42.98355351219673, -78.90518188476564], </span>
<span class="sd">	    ...     [43.04731443361136, -78.83857727050783], </span>
<span class="sd">	    ...     [43.02221961002041, -78.7108612060547], </span>
<span class="sd">	    ...     [42.92777124914475, -78.68957519531251], </span>
<span class="sd">	    ...     [42.866402688514626, -78.75343322753908], </span>
<span class="sd">	    ...     [42.874957707517865, -78.82415771484375], </span>
<span class="sd">	    ...     [42.90111863978987, -78.86878967285158], </span>
<span class="sd">	    ...     [42.92224052343343, -78.8921356201172]]</span>

<span class="sd">	The second example will give us 20 nodes, normally-distributed, centered at [42.30, 78.00], with a standard deviation of 2000 meters about the center.  However, the nodes must also fall within the bounding region.</span>
<span class="sd">	    &gt;&gt;&gt; myNodes2 = vrv.generateNodes(</span>
<span class="sd">	    ...     numNodes        = 20,</span>
<span class="sd">	    ...     nodeType        = &#39;depot&#39;, </span>
<span class="sd">	    ...     nodeDistrib     = &#39;normal&#39;, </span>
<span class="sd">	    ...     nodeDistribArgs = {</span>
<span class="sd">	    ...         &#39;center&#39; : [42.90, -78.80], </span>
<span class="sd">	    ...         &#39;stdDev&#39; : 2000,</span>
<span class="sd">	    ...         &#39;boundingRegion&#39; : bounding</span>
<span class="sd">	    ...     })</span>
<span class="sd">	    &gt;&gt;&gt; myNodes2</span>

<span class="sd">	View the center point, 1 std dev, 3 std devs, bounding region, and resulting nodes on a Leaflet map:</span>
<span class="sd">		&gt;&gt;&gt; myMap2 = vrv.addLeafletMarker(center      = [42.90, -78.80], </span>
<span class="sd">		...                               fillOpacity = 1)</span>
<span class="sd">		&gt;&gt;&gt; myMap2 = vrv.addLeafletCircle(mapObject = myMap2, </span>
<span class="sd">		...                               center    = [42.90, -78.80], </span>
<span class="sd">		...                               radius    = 4000, </span>
<span class="sd">		...                               fillColor = &#39;green&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myMap2 = vrv.addLeafletCircle(mapObject = myMap2, </span>
<span class="sd">		...                               center    = [42.90, -78.80], </span>
<span class="sd">		...                               radius    = 3*4000)</span>
<span class="sd">		&gt;&gt;&gt; myMap2 = vrv.createLeaflet(mapObject      = myMap2, </span>
<span class="sd">		...                            nodes          = myNodes2,</span>
<span class="sd">		...                            boundingRegion = bounding)</span>
<span class="sd">		&gt;&gt;&gt; myMap2</span>

<span class="sd">	The third example will generate 20 nodes uniformly distributed in a given bounding region:</span>
<span class="sd">	    &gt;&gt;&gt; myNodes3 = vrv.generateNodes(</span>
<span class="sd">	    ...     numNodes        = 20, </span>
<span class="sd">	    ...     nodeDistrib     = &#39;uniformBB&#39;, </span>
<span class="sd">	    ...     nodeDistribArgs = {</span>
<span class="sd">	    ...         &#39;boundingRegion&#39; : bounding</span>
<span class="sd">	    ...     })</span>
<span class="sd">	    &gt;&gt;&gt; myNodes3</span>

<span class="sd">	View the bounding region and generated nodes on a Leaflet map:</span>
<span class="sd">		&gt;&gt;&gt; myMap3 = vrv.createLeaflet(nodes          = myNodes3,</span>
<span class="sd">		...                            boundingRegion = bounding)</span>
<span class="sd">		&gt;&gt;&gt; myMap3</span>

<span class="sd">	The final example includes all available function arguments:</span>
<span class="sd">		&gt;&gt;&gt; myNodes4 = vrv.generateNodes(</span>
<span class="sd">		...     initNodes         = None,</span>
<span class="sd">		...     nodeType          = &#39;warehouse&#39;,</span>
<span class="sd">		...     nodeName          = &#39;WH &#39;,  </span>
<span class="sd">		...     numNodes          = 5,</span>
<span class="sd">		...     startNode         = 101,</span>
<span class="sd">		...     incrementName     = True,</span>
<span class="sd">		...     incrementStart    = 1,</span>
<span class="sd">		...     nodeDistrib       = &#39;uniformBB&#39;,</span>
<span class="sd">		...     nodeDistribArgs   = {</span>
<span class="sd">		...         &#39;boundingRegion&#39; : bounding</span>
<span class="sd">		...     },</span>
<span class="sd">		...     snapToRoad        = True,</span>
<span class="sd">		...     leafletIconPrefix = &#39;fa&#39;,</span>
<span class="sd">		...     leafletIconType   = &#39;star&#39;,</span>
<span class="sd">		...     leafletColor      = &#39;darkred&#39;,</span>
<span class="sd">		...     leafletIconText   = &#39;These nodes are used for demo&#39;,</span>
<span class="sd">		...     cesiumIconType    = &#39;pin&#39;,</span>
<span class="sd">		...     cesiumColor       = &#39;Cesium.Color.DARKRED&#39;,</span>
<span class="sd">		...     cesiumIconText    = None,</span>
<span class="sd">		...     dataProvider      = &#39;OSRM-online&#39;,</span>
<span class="sd">		...     dataProviderArgs  = None)</span>
<span class="sd">		&gt;&gt;&gt; myNodes4	    </span>

<span class="sd">	View the bounding region and generated nodes on a Leaflet map:</span>
<span class="sd">		&gt;&gt;&gt; myMap4 = vrv.createLeaflet(nodes          = myNodes4,</span>
<span class="sd">		...                            boundingRegion = bounding)</span>
<span class="sd">		&gt;&gt;&gt; myMap4</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valGenerateNodes</span><span class="p">(</span><span class="n">initNodes</span><span class="p">,</span> <span class="n">nodeType</span><span class="p">,</span> <span class="n">nodeName</span><span class="p">,</span> <span class="n">numNodes</span><span class="p">,</span> <span class="n">startNode</span><span class="p">,</span> <span class="n">incrementName</span><span class="p">,</span> <span class="n">incrementStart</span><span class="p">,</span> <span class="n">nodeDistrib</span><span class="p">,</span> <span class="n">nodeDistribArgs</span><span class="p">,</span> <span class="n">snapToRoad</span><span class="p">,</span> <span class="n">leafletIconPrefix</span><span class="p">,</span> <span class="n">leafletIconType</span><span class="p">,</span> <span class="n">leafletColor</span><span class="p">,</span> <span class="n">leafletIconText</span><span class="p">,</span> <span class="n">cesiumIconType</span><span class="p">,</span> <span class="n">cesiumColor</span><span class="p">,</span> <span class="n">cesiumIconText</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">VRV_SETTING_SHOWWARNINGMESSAGE</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="c1"># Generate random nodes - For 2D nodes</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nodeDistrib</span> <span class="o">==</span> <span class="s2">&quot;uniformBB&quot;</span><span class="p">):</span>
		<span class="n">boundingRegion</span> <span class="o">=</span> <span class="n">nodeDistribArgs</span><span class="p">[</span><span class="s1">&#39;boundingRegion&#39;</span><span class="p">]</span>
		<span class="n">locs</span> <span class="o">=</span> <span class="n">_genNodesUniformBounded</span><span class="p">(</span><span class="n">numNodes</span><span class="p">,</span> <span class="n">boundingRegion</span><span class="p">)</span>		
	<span class="k">elif</span> <span class="p">(</span><span class="n">nodeDistrib</span> <span class="o">==</span> <span class="s2">&quot;normal&quot;</span><span class="p">):</span>
		<span class="k">if</span> <span class="p">(</span><span class="s1">&#39;boundingRegion&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nodeDistribArgs</span><span class="p">):</span>
			<span class="n">center</span> <span class="o">=</span> <span class="n">nodeDistribArgs</span><span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">]</span>
			<span class="n">standardDeviation</span> <span class="o">=</span> <span class="n">nodeDistribArgs</span><span class="p">[</span><span class="s1">&#39;stdDev&#39;</span><span class="p">]</span>
			<span class="n">locs</span> <span class="o">=</span> <span class="n">_genNodesNormal</span><span class="p">(</span><span class="n">numNodes</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">standardDeviation</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">boundingRegion</span> <span class="o">=</span> <span class="n">nodeDistribArgs</span><span class="p">[</span><span class="s1">&#39;boundingRegion&#39;</span><span class="p">]</span>
			<span class="n">center</span> <span class="o">=</span> <span class="n">nodeDistribArgs</span><span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">]</span>
			<span class="n">standardDeviation</span> <span class="o">=</span> <span class="n">nodeDistribArgs</span><span class="p">[</span><span class="s1">&#39;stdDev&#39;</span><span class="p">]</span>
			<span class="n">locs</span> <span class="o">=</span> <span class="n">_genNodesNormalBounded</span><span class="p">(</span><span class="n">numNodes</span><span class="p">,</span> <span class="n">boundingRegion</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">standardDeviation</span><span class="p">)</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">nodeDistrib</span> <span class="o">==</span> <span class="s2">&quot;normalBB&quot;</span><span class="p">):</span>
		<span class="n">boundingRegion</span> <span class="o">=</span> <span class="n">nodeDistribArgs</span><span class="p">[</span><span class="s1">&#39;boundingRegion&#39;</span><span class="p">]</span>
		<span class="n">center</span> <span class="o">=</span> <span class="n">nodeDistribArgs</span><span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">]</span>
		<span class="n">standardDeviation</span> <span class="o">=</span> <span class="n">nodeDistribArgs</span><span class="p">[</span><span class="s1">&#39;stdDev&#39;</span><span class="p">]</span>
		<span class="n">locs</span> <span class="o">=</span> <span class="n">_genNodesNormalBounded</span><span class="p">(</span><span class="n">numNodes</span><span class="p">,</span> <span class="n">boundingRegion</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">standardDeviation</span><span class="p">)</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">nodeDistrib</span> <span class="o">==</span> <span class="s2">&quot;unifRoadBasedBB&quot;</span><span class="p">):</span>
		<span class="n">boundingRegion</span> <span class="o">=</span> <span class="n">nodeDistribArgs</span><span class="p">[</span><span class="s1">&#39;boundingRegion&#39;</span><span class="p">]</span>
		<span class="n">distToRoad</span> <span class="o">=</span> <span class="n">nodeDistribArgs</span><span class="p">[</span><span class="s1">&#39;distToRoad&#39;</span><span class="p">]</span>
		<span class="n">locs</span> <span class="o">=</span> <span class="n">_genNodesRoadBased</span><span class="p">(</span><span class="n">numNodes</span><span class="p">,</span> <span class="n">boundingRegion</span><span class="p">,</span> <span class="n">distToRoad</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>

	<span class="c1"># create nodes from given lats/lons</span>
	<span class="n">nodes</span> <span class="o">=</span> <span class="n">privCreateNodesFromLocs</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span> <span class="n">initNodes</span><span class="p">,</span> <span class="n">nodeType</span><span class="p">,</span> <span class="n">nodeName</span><span class="p">,</span> <span class="n">startNode</span><span class="p">,</span> <span class="n">incrementName</span><span class="p">,</span> <span class="n">incrementStart</span><span class="p">,</span> <span class="n">snapToRoad</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">,</span> <span class="n">leafletIconPrefix</span><span class="p">,</span> <span class="n">leafletIconType</span><span class="p">,</span> <span class="n">leafletColor</span><span class="p">,</span> <span class="n">leafletIconText</span><span class="p">,</span> <span class="n">cesiumIconType</span><span class="p">,</span> <span class="n">cesiumColor</span><span class="p">,</span> <span class="n">cesiumIconText</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">nodes</span></div>

<span class="k">def</span> <span class="nf">_genNodesUniformBounded</span><span class="p">(</span><span class="n">numNodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boundingRegion</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generate randomized node using Uniform distribution within a bounding area</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	This function is an approximation, the error is getting larger when the location is closer to poles</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	numNodes: int, Required</span>
<span class="sd">		Number of nodes to be generated</span>
<span class="sd">	boudingArea: list, Required</span>
<span class="sd">		A defined polygon, nodes are generated within this area</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	list of lists</span>
<span class="sd">		A list of coordinates uniformly distributed with bounding region</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># Use polygon triangulation to cut the bounding region into a list of triangules, calculate the area of each triangle</span>
	<span class="n">lstTriangle</span> <span class="o">=</span> <span class="n">tripy</span><span class="o">.</span><span class="n">earclip</span><span class="p">(</span><span class="n">boundingRegion</span><span class="p">)</span>
	<span class="n">lstArea</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lstTriangle</span><span class="p">)):</span>
		<span class="n">lstArea</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">areaOfTriangle</span><span class="p">(</span><span class="n">lstTriangle</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">lstTriangle</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">lstTriangle</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
	
	<span class="c1"># Randomly pick a triangle, the probability of picking triangle is refer to the area of each triangle, then generate one node inside, loop untill generate enough nodes</span>
	<span class="n">locs</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numNodes</span><span class="p">):</span>
		<span class="n">index</span> <span class="o">=</span> <span class="n">randomPick</span><span class="p">(</span><span class="n">lstArea</span><span class="p">)</span>
		<span class="n">newLoc</span> <span class="o">=</span> <span class="n">_genNodesUniformTriangle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lstTriangle</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
		<span class="n">locs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">newLoc</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">locs</span>

<span class="k">def</span> <span class="nf">_genNodesUniformTriangle</span><span class="p">(</span><span class="n">numNodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">triangle</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generate randomized node using Uniform distribution within a triangle</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	This function is an approximation, the error is getting larger when the location is closer to poles</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	numNodes: int, Required</span>
<span class="sd">		Number of nodes to be generated</span>
<span class="sd">	triangle: list, Required</span>
<span class="sd">		A defined triangle, format is [[lat1, lon1], [lat2, lon2], [lat3, lon3]]</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	list of lists</span>
<span class="sd">		A list of coordinates randomly generated at given triangle</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># Give number to three vertices of triangle</span>
	<span class="p">[</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">]</span> <span class="o">=</span> <span class="n">triangle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
	<span class="p">[</span><span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">]</span> <span class="o">=</span> <span class="n">triangle</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
	<span class="p">[</span><span class="n">lat3</span><span class="p">,</span> <span class="n">lon3</span><span class="p">]</span> <span class="o">=</span> <span class="n">triangle</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

	<span class="c1"># initialize lists</span>
	<span class="n">locs</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="c1"># Generate random nodes</span>
	<span class="c1"># Reference: http://www.cs.princeton.edu/~funk/tog02.pdf</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numNodes</span><span class="p">):</span>
		<span class="n">rndR1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">rndR2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">rndLat</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rndR1</span><span class="p">))</span> <span class="o">*</span> <span class="n">lat1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rndR1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rndR2</span><span class="p">)</span> <span class="o">*</span> <span class="n">lat2</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rndR1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rndR2</span> <span class="o">*</span> <span class="n">lat3</span>
		<span class="n">rndLon</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rndR1</span><span class="p">))</span> <span class="o">*</span> <span class="n">lon1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rndR1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rndR2</span><span class="p">)</span> <span class="o">*</span> <span class="n">lon2</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rndR1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rndR2</span> <span class="o">*</span> <span class="n">lon3</span>
		<span class="n">locs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">rndLat</span><span class="p">,</span> <span class="n">rndLon</span><span class="p">])</span>

	<span class="k">return</span> <span class="n">locs</span>

<span class="k">def</span> <span class="nf">_genNodesNormalBounded</span><span class="p">(</span><span class="n">numNodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boundingRegion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">standardDeviation</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generate randomized node using Normal distribution within a bounding area</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	numNodes: int, Required</span>
<span class="sd">		Number of nodes to be generated</span>
<span class="sd">	boudingArea: list, Required</span>
<span class="sd">		A defined polygon, nodes are generated within this area</span>
<span class="sd">	centerLat: float, Required</span>
<span class="sd">		Latitude of the center point</span>
<span class="sd">	centerLon: float, Required</span>
<span class="sd">		Longitude of the center point</span>
<span class="sd">	standardDeviation: float, Required</span>
<span class="sd">		StandardDeviation of normal distribution</span>

<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	list of lists</span>
<span class="sd">		A list of coordinates uniformly distributed within a bounding area</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># Initialize</span>
	<span class="n">locs</span> <span class="o">=</span> <span class="p">[]</span>

	<span class="c1"># Randomized generate nodes in normal distribution</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numNodes</span><span class="p">):</span>
		<span class="n">rndUniform</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>
		<span class="n">rndNormal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">standardDeviation</span><span class="p">)</span>
		<span class="n">newLoc</span> <span class="o">=</span> <span class="n">geoPointInDistance2D</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">rndUniform</span><span class="p">,</span> <span class="n">rndNormal</span><span class="p">)</span>
		<span class="k">while</span> <span class="p">(</span><span class="ow">not</span> <span class="n">geoIsPointInPoly</span><span class="p">(</span><span class="n">newLoc</span><span class="p">,</span> <span class="n">boundingRegion</span><span class="p">)):</span>
			<span class="n">rndUniform</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>
			<span class="n">rndNormal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">standardDeviation</span><span class="p">)</span>
			<span class="n">newLoc</span> <span class="o">=</span> <span class="n">geoPointInDistance2D</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">rndUniform</span><span class="p">,</span> <span class="n">rndNormal</span><span class="p">)</span>
		<span class="n">locs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newLoc</span><span class="p">)</span>
		
	<span class="k">return</span> <span class="n">locs</span>

<span class="k">def</span> <span class="nf">_genNodesNormal</span><span class="p">(</span><span class="n">numNodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">standardDeviation</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generate randomized node using Normal distribution within a bounding area</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	numNodes: int</span>
<span class="sd">		Required, number of nodes to be generated</span>
<span class="sd">	centerLat: float, Required</span>
<span class="sd">		Latitude of the center point</span>
<span class="sd">	centerLon: float, Required</span>
<span class="sd">		Longitude of the center point</span>
<span class="sd">	standardDeviation: float, Required</span>
<span class="sd">		StandardDeviation of normal distribution</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	list of lists</span>
<span class="sd">		A list of coordinates uniformly distributed</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># Initialize</span>
	<span class="n">locs</span> <span class="o">=</span> <span class="p">[]</span>

	<span class="c1"># Randomized generate nodes in normal distribution</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numNodes</span><span class="p">):</span>
		<span class="n">rndUniform</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>
		<span class="n">rndNormal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">standardDeviation</span><span class="p">)</span>
		<span class="n">newLoc</span> <span class="o">=</span> <span class="n">geoPointInDistance2D</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">rndUniform</span><span class="p">,</span> <span class="n">rndNormal</span><span class="p">)</span>
		<span class="n">locs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newLoc</span><span class="p">)</span>
		
	<span class="k">return</span> <span class="n">locs</span>

<span class="k">def</span> <span class="nf">_genNodesRoadBased</span><span class="p">(</span><span class="n">numNodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boundingRegion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">distToRoad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProvider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">APIkey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">databaseName</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generate randomized node using Uniform distribution within a bounding area and close to roads</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	This function is an approximation, the error is getting larger when the location is closer to poles</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	numNodes: int, Required</span>
<span class="sd">		Number of nodes to be generated</span>
<span class="sd">	boudingArea: list, Required</span>
<span class="sd">		A defined polygon, nodes are generated within this area</span>
<span class="sd">	distToRoad: float, Required</span>
<span class="sd">		The maximun distance to road for generated nodes.</span>
<span class="sd">	dataProvider: string, Conditional, See :ref:`Dataprovider`</span>
<span class="sd">		Specifies the data source to be used for generating nodes on a road network.  </span>
<span class="sd">	APIkey: string, Conditional, See :ref:`Dataprovider`</span>
<span class="sd">		Some data providers require an API key (which you&#39;ll need to register for).</span>
<span class="sd">	databaseName: string, Conditional, See :ref:`Dataprovider`</span>
<span class="sd">		If you are hosting a data provider on your local machine (e.g., pgRouting), you&#39;ll need to specify the name of the local database. </span>
<span class="sd">	</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	list of lists</span>
<span class="sd">		A list of coordinates, within a given distance to its nearest street</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># Initialize</span>
	<span class="n">locs</span> <span class="o">=</span> <span class="p">[]</span>

	<span class="c1"># Generate nodes, if it is not close enough, discard and regenerate</span>
	<span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">numNodes</span><span class="p">):</span>
		<span class="n">newLocs</span> <span class="o">=</span> <span class="n">_genNodesUniformBounded</span><span class="p">(</span><span class="n">numNodes</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">),</span> <span class="n">boundingRegion</span><span class="p">)</span>
		<span class="n">snapLocs</span> <span class="o">=</span> <span class="n">privGetSnapLocBatch</span><span class="p">(</span><span class="n">newLocs</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">APIkey</span><span class="p">,</span> <span class="n">databaseName</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">snapLocs</span><span class="p">)):</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">geoDistance2D</span><span class="p">(</span><span class="n">newLocs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">snapLocs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">distToRoad</span><span class="p">):</span>
				<span class="n">locs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newLocs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
	
	<span class="k">return</span> <span class="n">locs</span>

<div class="viewcode-block" id="createNodesFromLocs"><a class="viewcode-back" href="../../veroviz.generateNodes.html#veroviz.generateNodes.createNodesFromLocs">[docs]</a><span class="k">def</span> <span class="nf">createNodesFromLocs</span><span class="p">(</span><span class="n">locs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initNodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodeType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodeName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">startNode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">incrementName</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">incrementStart</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">snapToRoad</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dataProvider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">leafletIconPrefix</span><span class="o">=</span><span class="n">VRV_DEFAULT_LEAFLETICONPREFIX</span><span class="p">,</span> <span class="n">leafletIconType</span><span class="o">=</span><span class="n">VRV_DEFAULT_LEAFLETICONTYPE</span><span class="p">,</span> <span class="n">leafletColor</span><span class="o">=</span><span class="n">VRV_DEFAULT_LEAFLETICONCOLOR</span><span class="p">,</span> <span class="n">leafletIconText</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cesiumIconType</span><span class="o">=</span><span class="n">VRV_DEFAULT_CESIUMICONTYPE</span><span class="p">,</span> <span class="n">cesiumColor</span><span class="o">=</span><span class="n">VRV_DEFAULT_CESIUMICONCOLOR</span><span class="p">,</span> <span class="n">cesiumIconText</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	This function generates a &quot;nodes&quot; dataframe from a given collection of [lat, lon], or [lat, lon, alt], coordinates.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	locs: list of lists, Required, default as None</span>
<span class="sd">		A list of locations, in the form of [[lat, lon, alt], [lat, lon, alt], ...] or [[lat, lon], [lat, lon], ...].  If no altitudes are provided, all will be assumed to be 0 meters above ground level.</span>
<span class="sd">	initNodes: :ref:`Nodes`, Optional, default as None</span>
<span class="sd">		A :ref:`Nodes` dataframe containing an existing set of nodes. If `initNodes` is provided, this function will append to that dataframe.</span>
<span class="sd">	nodeType: string, Optional, default as None</span>
<span class="sd">		A user-defined text field that can be used to classify nodes. This field is to categorize a batch of nodes (e.g., &quot;warehouses&quot;). If provided, all nodes generated by the `generateNodes()` function call will be given this value. The nodeType is not used by VeRoViz explicitly. </span>
<span class="sd">	nodeName: string, Optional, default as None</span>
<span class="sd">		The name of all nodes that are to be generated by this function call. This field is a more detailed description (e.g., &quot;Buffalo WH&quot; or &quot;Berlin WH&quot;). The nodeName is not used by VeRoViz explicitly.  If provided, all nodes will use this nodeName.  See the `incrementName` flag below.</span>
<span class="sd">	startNode: int, Optional, default as 1</span>
<span class="sd">		Specifies the starting node number.  This will be the maximum of startNode and any id values contained in the `id` column of the `initNodes` dataframe (if provided).  </span>
<span class="sd">	incrementName: boolean, Optional, default as False</span>
<span class="sd">		If this flag is set to `True, a unique integer value will be appended to the `nodeName`.  For example, if `nodeName = &#39;WH&#39;` and `incrementName = True`, then the effective node names for 3 nodes would be &#39;WH1&#39;, &#39;WH2&#39;, and &#39;WH3&#39;.</span>
<span class="sd">	incrementStart: int, Optional, default as 1</span>
<span class="sd">		The starting number of the nodeName increment.  See the `nodeName` and `incrementName` parameters above.</span>
<span class="sd">	snapToRoad: boolean, Optional, default as False, </span>
<span class="sd">		If True, nodes will be positioned at locations on the road network. This requires the use of a data provider. See :ref:`Data Providers` for a list of data providers that support this option.</span>
<span class="sd">	dataProvider: string, Conditional, default as None</span>
<span class="sd">		Specifies the data source to be used for generating nodes on a road network. See :ref:`Data Providers` for options and requirements.</span>
<span class="sd">	dataProviderArgs: dictionary, Conditional, default as None</span>
<span class="sd">		For some data providers, additional parameters are required (e.g., API keys or database names). See :ref:`Data Providers` for the additional arguments required for each supported data provider.</span>
<span class="sd">	leafletIconPrefix: string, Optional, default as &quot;glyphicon&quot;</span>
<span class="sd">		There are a large number of Leaflet icons available. The `leafletIconPrefix` identifies one of two collections: &quot;glyphicon&quot; or &quot;fa&quot;.  See :ref:`Leaflet Style` for more information.</span>
<span class="sd">	leafletIconType: string, Optional, default as &quot;info-sign&quot;</span>
<span class="sd">		Specifies the particular icon to be used for all generated nodes.  The list of available options depends on the choice of `leafletIconType`. See :ref:`Leaflet Style` for available options.</span>
<span class="sd">	leafletColor: string, Optional, default as &quot;blue&quot;</span>
<span class="sd">		Specifies the icon color of the generated nodes when displayed in Leaflet. See :ref:`Leaflet Style` for a list of available colors.</span>
<span class="sd">	leafletIconText: string, Optional, default as None</span>
<span class="sd">		Specifies the text in label that will be displayed when the node is clicked on a Leaflet map.  This parameter allows for including more information if the node name itself is not sufficiently descriptive.</span>
<span class="sd">	cesiumIconType: string, Optional, default as &quot;pin&quot;</span>
<span class="sd">		&#39;pin&#39; is current the only option. See :ref:`Cesium Style`.</span>
<span class="sd">	cesiumColor: string, Optional, default as &quot;Cesium.Color.BLUE&quot;</span>
<span class="sd">		The color of the generated nodes when displayed in Cesium.  See :ref:`Cesium Style` for all available color options.</span>
<span class="sd">	cesiumIconText: string, Optional, default as None</span>
<span class="sd">		Text that will be permanently displayed within the node on a Cesium map. If this field is None, in Cesium the node will be displayed with the `id` value. </span>


<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	:ref:`Nodes` dataframe</span>
<span class="sd">		A :ref:`Nodes` dataframe generated from the given list of coordinates.</span>


<span class="sd">	Examples</span>
<span class="sd">	--------</span>

<span class="sd">	Import veroviz and check if it is the latest version:</span>
<span class="sd">	    &gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">	    &gt;&gt;&gt; vrv.checkVersion()</span>
<span class="sd">	    </span>
<span class="sd">	    </span>
<span class="sd">	Generate nodes from a list of [lat, lon] pairs (no altitude specified):</span>
<span class="sd">		&gt;&gt;&gt; nodes2D = vrv.createNodesFromLocs(</span>
<span class="sd">		...     locs=[</span>
<span class="sd">		...         [42.1538, -78.4253],</span>
<span class="sd">		...         [42.3465, -78.6234],</span>
<span class="sd">		...         [42.6343, -78.1146]])</span>
<span class="sd">		&gt;&gt;&gt; nodes2D</span>

<span class="sd">	Generate nodes from a list of [lat, lon, alt] pairs:</span>
<span class="sd">		&gt;&gt;&gt; nodes3D = vrv.createNodesFromLocs(</span>
<span class="sd">		...     locs=[</span>
<span class="sd">		...         [42.1538, -78.4253, 200],</span>
<span class="sd">		...         [42.3465, -78.6234, 400],</span>
<span class="sd">		...         [42.6343, -78.1146, 200]])</span>
<span class="sd">		&gt;&gt;&gt; nodes3D</span>

<span class="sd">	This example includes all function arguments:</span>
<span class="sd">		&gt;&gt;&gt; myLocs = [[42.1538, -78.4253],</span>
<span class="sd">		...           [42.3465, -78.6234],</span>
<span class="sd">		...           [42.6343, -78.1146]]</span>
<span class="sd">		&gt;&gt;&gt; myNodes = vrv.createNodesFromLocs(</span>
<span class="sd">		...     locs              = myLocs, </span>
<span class="sd">		...     initNodes         = None, </span>
<span class="sd">		...     nodeType          = &#39;customers&#39;, </span>
<span class="sd">		...     nodeName          = &#39;cust&#39;, </span>
<span class="sd">		...     startNode         = 1, </span>
<span class="sd">		...     incrementName     = True, </span>
<span class="sd">		...     incrementStart    = 7, </span>
<span class="sd">		...     snapToRoad        = False, </span>
<span class="sd">		...     dataProvider      = None, </span>
<span class="sd">		...     dataProviderArgs  = None,</span>
<span class="sd">		...     leafletIconPrefix = &#39;fa&#39;, </span>
<span class="sd">		...     leafletIconType   = &#39;user&#39;, </span>
<span class="sd">		...     leafletColor      = &#39;lightgreen&#39;, </span>
<span class="sd">		...     leafletIconText   = None, </span>
<span class="sd">		...     cesiumIconType    = &#39;pin&#39;, </span>
<span class="sd">		...     cesiumColor       = &#39;Cesium.Color.LIGHTGREEN&#39;, </span>
<span class="sd">		...     cesiumIconText    = None)</span>
<span class="sd">		&gt;&gt;&gt; myNodes</span>

<span class="sd">	Display the nodes on a Leaflet map:</span>
<span class="sd">		&gt;&gt;&gt; vrv.createLeaflet(nodes = nodes2D)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valCreateNodesFromLocs</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span> <span class="n">initNodes</span><span class="p">,</span> <span class="n">nodeType</span><span class="p">,</span> <span class="n">nodeName</span><span class="p">,</span> <span class="n">startNode</span><span class="p">,</span> <span class="n">incrementName</span><span class="p">,</span> <span class="n">incrementStart</span><span class="p">,</span> <span class="n">snapToRoad</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">,</span> <span class="n">leafletIconPrefix</span><span class="p">,</span> <span class="n">leafletIconType</span><span class="p">,</span> <span class="n">leafletColor</span><span class="p">,</span> <span class="n">leafletIconText</span><span class="p">,</span> <span class="n">cesiumIconType</span><span class="p">,</span> <span class="n">cesiumColor</span><span class="p">,</span> <span class="n">cesiumIconText</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">VRV_SETTING_SHOWWARNINGMESSAGE</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">nodes</span> <span class="o">=</span> <span class="n">privCreateNodesFromLocs</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span> <span class="n">initNodes</span><span class="p">,</span> <span class="n">nodeType</span><span class="p">,</span> <span class="n">nodeName</span><span class="p">,</span> <span class="n">startNode</span><span class="p">,</span> <span class="n">incrementName</span><span class="p">,</span> <span class="n">incrementStart</span><span class="p">,</span> <span class="n">snapToRoad</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">,</span> <span class="n">leafletIconPrefix</span><span class="p">,</span> <span class="n">leafletIconType</span><span class="p">,</span> <span class="n">leafletColor</span><span class="p">,</span> <span class="n">leafletIconText</span><span class="p">,</span> <span class="n">cesiumIconType</span><span class="p">,</span> <span class="n">cesiumColor</span><span class="p">,</span> <span class="n">cesiumIconText</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">nodes</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">veroviz 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../veroviz.html" >veroviz</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, optimatorlab.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>